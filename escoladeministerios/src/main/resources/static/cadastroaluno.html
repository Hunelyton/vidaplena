<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vida Plena Escola de Ministérios</title>
<!-- Link para o Bootstrap CSS -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
<!-- Seu arquivo CSS personalizado (cadastroaluno.css) -->
<link rel="stylesheet" href="cadastroaluno.css">
</head>
<body>
	<div class="container">
		<h1 class="mt-5">Cadastro de Alunos</h1>
		<form action="" class="formCadastroAluno">
			<div class="row mb-3">
				<div class="col">
					<label for="id" class="form-label fs-6">ID:</label> <input
						type="text" class="form-control" id="id" placeholder=""
						readonly="readonly">
				</div>
				<div class="col">
					<label for="cpf" class="form-label">CPF:</label> <input type="text"
						class="form-control" id="cpf" placeholder="12345678900">
				</div>
			</div>

			<div class="row mb-3">
				<div class="col">
					<label for="nome" class="form-label">Nome:</label> <input
						type="text" class="form-control" id="nome"
						placeholder="Nome Completo">
				</div>
			</div>
			<div class="row mb-3">
				<div class="col">
					<label for="telefone" class="form-label fs-6">Telefone:</label> <input
						type="text" class="form-control" id="telefone"
						placeholder="Exemplo: 13912345678">
				</div>
				<div class="col">
					<label for="email" class="form-label">E-mail:</label> <input
						type="text" class="form-control" id="email"
						placeholder="exemplo@exemplo.com.br">
				</div>
			</div>
			<div class="row mb-3">
				<div class="col">
					<label for="endereco" class="form-label">Endereço:</label> <input
						type="text" class="form-control" id="endereco"
						placeholder="Exemplo: Rua Central, 123 - Centro">
				</div>
			</div>
			<div class="row mb-3">
				<div class="col">
					<label for="bairro" class="form-label">Bairro:</label> <input
						type="text" class="form-control" id="bairro"
						placeholder="Exemplo: Centro">
				</div>
				<div class="col">
					<label for="cidade" class="form-label">Cidade:</label> <input
						type="text" class="form-control" id="cidade" placeholder="Cidade">
				</div>

				<div class="col">
					<label for="uf" class="form-label">Estado:</label> <select
						id="uf" class="form-select">
						<option value="" selected>Escolha a UF</option>
						<option value="AC">AC</option>
						<option value="AL">AL</option>
						<option value="AP">AP</option>
						<option value="AM">AM</option>
						<option value="BA">BA</option>
						<option value="CE">CE</option>
						<option value="DF">DF</option>
						<option value="ES">ES</option>
						<option value="GO">GO</option>
						<option value="MA">MA</option>
						<option value="MT">MT</option>
						<option value="MS">MS</option>
						<option value="MG">MG</option>
						<option value="PA">PA</option>
						<option value="PB">PB</option>
						<option value="PR">PR</option>
						<option value="PE">PE</option>
						<option value="PI">PI</option>
						<option value="RJ">RJ</option>
						<option value="RN">RN</option>
						<option value="RS">RS</option>
						<option value="RO">RO</option>
						<option value="RR">RR</option>
						<option value="SC">SC</option>
						<option value="SP">SP</option>
						<option value="SE">SE</option>
						<option value="TO">TO</option>
					</select>
				</div>
			</div>
			<div class="row mb-3">
				<div class="col">
					<label for="cep" class="form-label">CEP:</label> <input type="text"
						class="form-control" id="cep" placeholder="12345-678">
				</div>
			</div>
		</form>
		<button type="button" class="btn btn-primary"
			onclick="salvarUsuario()">SALVAR</button>
		<button type="button" class="btn btn-success">NOVO</button>
		<button type="button" class="btn btn-danger" data-bs-toggle="modal"
			data-bs-target="#exampleModal">PESQUISAR</button>



		<div class="modal fade" id="exampleModal" tabindex="-1"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Pesquisa de
							alunos</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>


					<div class="modal-body">
						<form>
							<div class="mb-3">
								<label for="nomeAluno" class="col-form-label">Buscar
									Alunos:</label> <input type="text" class="form-control" id="nomeAluno"
									placeholder="Digite o nome ou matrícula do aluno">

							</div>

							<button type="button" class="btn btn-danger"
								onclick="pesquisaAluno()">BUSCAR</button>

						</form>

						<table class="table" id="tabelaResultado">
							<thead>
								<tr>
									<th scope="col">ID</th>
									<th scope="col">NOME</th>
									<th scope="col">TELEFONE</th>
									<th scope="col">AÇÕES</th>
								</tr>
							</thead>
							<tbody>

							</tbody>
						</table>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">SAIR</button>

					</div>
				</div>
			</div>
		</div>



	</div>

	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
		crossorigin="anonymous"></script>
		
	<!-- Scripts do Bootstrap -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

	<script type="text/javascript">
	
	/*EDITA ALUNO*/
		function editarAluno(id) {
			$.ajax({
				method : "GET",
				url : "buscaralunoid",
				data : "idaluno=" + id,
				success : function(response) {
					$("#id").val(response.id);
					$("#nome").val(response.nome);
					$("#telefone").val(response.telefone);
					$("#email").val(response.email);
					$("#endereco").val(response.endereco);
					$("#cidade").val(response.cidade);
					$("#bairro").val(response.bairro);
					$("#uf").val(response.uf);
					$("#cep").val(response.cep);
					$("#cpf").val(response.cpf);
					
					
					$('#exampleModal').modal('hide')
				}
			}).fail(function(xhr, status, erroThrown) {
				alert("Erro ao buscar aluno: " + xhr.responseText);
			});

		}
		
	
		
	/*PESQUISA ALUNO*/
		function pesquisaAluno() {
			var nome = $("#nomeAluno").val();
			var telefone = $("#telefone").val();

			if (nome != null && nome.trim() != '') {

				$
						.ajax(
								{
									method : "GET",
									url : "buscarPorNome",
									data : "name=" + nome, // Corrigido para buscar por nome
									success : function(response) {
										$('#tabelaResultado > tbody > tr')
												.remove();

										for (var i = 0; i < response.length; i++) {
										    $('#tabelaResultado > tbody').append(
										        '<tr><td>' + response[i].id + '</td><td>' + response[i].nome + '</td><td>' + response[i].telefone + '</td><td><button type="button" class="btn btn-primary" onclick="editarAluno(' + response[i].id + ')">EDITAR</button></td></tr>'
										    );
										}

									}
								}).fail(function(xhr, status, erroThrown) {
							alert("Erro ao buscar aluno: " + xhr.responseText);
						});
			}
		}
		
		/*SALVA ALUNO*/
		function salvarUsuario() {
			var id = $("#id").val();
			var nome = $("#nome").val();
			var telefone = $("#telefone").val();
			var email = $("#email").val();
			var endereco = $("#endereco").val();
			var cidade = $("#cidade").val();
			var bairro = $("#bairro").val();
			var uf = $("#uf").val();
			var cep = $("#cep").val();
			var cpf = $("#cpf").val();

			$.ajax({
				method : "POST",
				url : "salvaralunos",
				data : JSON.stringify({
					id: id,
					nome: nome,
					telefone: telefone,
					email: email,
					endereco: endereco,
					cidade: cidade,
					bairro: bairro,
					uf: uf,
					cep: cep,
					cpf: cpf
				}),
				contentType : "application/json; charset=utf-8",
				success : function(response) {
					alert("Aluno incluído com sucesso !");
				}
			}).fail(function(xhr, status, erroThrown) {
				alert("Erro ao incluir aluno: " + xhr.responseText);
			});
		}
		
		
		
	</script>
</body>
</html>